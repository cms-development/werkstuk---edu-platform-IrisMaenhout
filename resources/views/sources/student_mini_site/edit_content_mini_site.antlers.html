{{?
    use Statamic\Facades\Entry;

    $entry = Entry::findByUri('/' . $source_slug);
    $document_content = $entry->get('document_content');

    function saveCookie($content)
    {
        setcookie("pageContent", json_encode($content), time()+3600, '/');
    }


    foreach($document_content as $key => $content) {
        if(isset($folder_slug)){
            if(isset($content['title_folder']) && strtolower(trim(preg_replace('/[^A-Za-z0-9-]+/', '-', $content['title_folder']))) === $folder_slug){

                foreach ($content['pages'] as $key => $page) {
                    if($page_slug === $page["slug"]){
                        saveCookie($page['page_layout']);
                    }
                }
            }


        }else{
            if(isset($content["slug"]) && $page_slug === $content["slug"]){
                saveCookie($content['page_layout']);
            }
        }


    }

?}}


{{ partial:check_access }}
{{ collection:sources slug:is="{{ source_slug }}" status:in="published|draft" }}
    <div class="mt-20 w-full fixed shadow-md z-[5]">
        <div class="w-full bg-[#B0D2A8] flex justify-between py-6 px-12 items-center">
            <div>
                {{ if page_slug === 'start-pagina'}}
                    <h3 class="mt-2 mb-4 text-xl ">Start pagina</h3>
                {{ else }}
                    {{# page name #}}
                {{ /if }}

                <p>Account/ thema-dossiers/ name-website</p>
            </div>

            <div class="{{$ $page_slug !== 'start-pagina' ? 'flex gap-24 items-center' : '' $}} ">
                {{ if $page_slug !== 'start-pagina' }}
                    <form action="/remove-page" method="post" name="delete page">
                        {{ csrf_field }}
                        <input type="hidden" name="source_id" value="{{ id }}">
                        <input type="hidden" name="page_slug" value=" {{ page_slug }}">
                        <input type="hidden" name="location" value="{{$ isset($folder_slug) ? $folder_slug : 'root' $}}">

                        <button type="submit" class="flex justify-center items-center w-14 h-14 bg-white rounded-full">
                            <i class="fa-regular fa-trash-can text-[#ee7070] text-2xl block"></i>
                        </button>
                    </form>
                {{ /if }}

                <form action="/update-{{$ $page_slug === 'start-pagina' ? 'main-page' : 'page' $}}" method="post" name="update page content">
                    {{ csrf_field }}
                    <input type="hidden" name="page_content" class="page-content">
                    <input type="hidden" name="source_id" value="{{ id }}">
                    <input type="hidden" name="page_slug" value=" {{ page_slug }}">
                    <input type="hidden" name="location" value="{{$ isset($folder_slug) ? $folder_slug : 'root' $}}">

                    <button type="submit" class="primary-btn">Opslaan</button>
                </form>
            </div>

        </div>

        <div class="bg-slate-50 px-[5%]">
            <div class="flex justify-between">
                <button class="h2-btn p-4" name="bold">
                    <div class="flex items-center">
                        <i class="fa fa-header"></i>
                        <sub class=" font-bold">2</sub>
                    </div>
                </button>

                <button class="h3-btn p-4" name="bold">
                    <div class="flex items-center">
                        <i class="fa fa-header"></i>
                        <sub class=" font-bold">3</sub>
                    </div>
                </button>
                <button class="h4-btn p-4" name="bold">
                    <div class="flex items-center">
                        <i class="fa fa-header"></i>
                        <sub class="font-bold">4</sub>
                    </div>
                </button>

                <button class="bold-btn p-4" name="bold">
                    <i class="fa-solid fa-bold"></i>
                </button>

                <button class="italic-btn p-4">
                    <i class="fa-solid fa-italic"></i>
                </button>

                <button class="underline-btn p-4">
                    <i class="fa-solid fa-underline"></i>
                </button>

                <button class="strikethrough-btn p-4">
                    <i class="fa-solid fa-strikethrough"></i>
                </button>

                <button class="unorderedlist-btn p-4">
                    <i class="fa-solid fa-list-ul"></i>
                </button>

                <button class="orderedlist-btn p-4">
                    <i class="fa-solid fa-list-ol"></i>
                </button>

                <button class="quote-btn p-4">
                    <i class="fa-solid fa-quote-right"></i>
                </button>

                <button class="link-btn p-4">
                    <i class="fa-solid fa-link"></i>
                </button>

                <button class="img-btn p-4">
                    <i class="fa-solid fa-image"></i>
                </button>

                <button class="add-table-btn p-4">
                    <i class="fa-solid fa-table"></i>
                </button>

            </div>

            <p class="word-count"></p>
        </div>
    </div>


    {{ if page_slug === 'start-pagina'}}
        {{# <div class=" py-56">
            <form action="/update-main-page" method="POST" title="update start pagina" enctype="multipart/form-data">
                {{ csrf_field }}

                <input type="hidden" name="entry_id" value="{{ id }}">


                <label for="hero_description">Hero description</label><br>
                <textarea name="hero_description" id="" cols="30" rows="10"></textarea>
                <br>

                <label for="main_page_content">Main page content</label><br>
                <textarea name="main_page_content" id="" cols="30" rows="10"></textarea>
                <br>

            <button type="submit">Update start pagina</button>

            </form>

        </div> #}}


        <!-- Create the editor container -->

    {{ else }}

    {{ /if }}
{{ /collection:sources }}

<div class=" py-80 px-24">


    <div class="wysiwyg-editor"></div>

</div>

{{# <script type="module">
    import {
        Editor
    } from '@tiptap/core';

    const editorElement = document.querySelector('.wysiwyg-editor');

    Editor.commands.setContent({
        "type": "doc",
        "content": "<?php echo'$current_page_layout'?>",
    });
</script> #}}
